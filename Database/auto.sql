-- phpMyAdmin SQL Dump
-- version 5.2.0
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Dec 13, 2022 at 03:01 AM
-- Server version: 10.4.25-MariaDB
-- PHP Version: 7.4.30

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `job`
--

-- --------------------------------------------------------

--
-- Table structure for table `admin`
--

CREATE TABLE `admin` (
  `ID` int(11) NOT NULL,
  `NAME` varchar(100) NOT NULL,
  `GENDER` varchar(30) NOT NULL,
  `D_O_B` varchar(100) NOT NULL,
  `PHONE` varchar(10) NOT NULL,
  `ADDRESS` varchar(200) NOT NULL,
  `ORGANIZATION` varchar(100) NOT NULL,
  `POSITION` varchar(100) NOT NULL,
  `AVATAR` longblob DEFAULT NULL,
  `EMAIL` varchar(50) NOT NULL,
  `USERNAME` varchar(50) NOT NULL,
  `PASS` varchar(300) NOT NULL,
  `QUESTION` varchar(200) NOT NULL,
  `ANSWER` varchar(200) NOT NULL,
  `TOTAL_WORKING_HOUR` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `admin`
--

INSERT INTO `admin` (`ID`, `NAME`, `GENDER`, `D_O_B`, `PHONE`, `ADDRESS`, `ORGANIZATION`, `POSITION`, `AVATAR`, `EMAIL`, `USERNAME`, `PASS`, `QUESTION`, `ANSWER`, `TOTAL_WORKING_HOUR`) VALUES
(1, 'HUYNH HUU BAO KHOA', 'NAM', '14-11-2001', '0372753988', '2, TAN AN, THI TRAN CAI TAC, HAU GIANG', 'DAI HOC CAN THO', 'HIEU TRUONG', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'ADMIN@GMAIL.COM', 'ADMIN', '73ACD9A5972130B75066C82595A1FA', 'WHAT IS YOUR FAVORITE FOOD?', 'KHOA', 773);

-- --------------------------------------------------------

--
-- Table structure for table `category`
--

CREATE TABLE `category` (
  `NAME` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `category`
--

INSERT INTO `category` (`NAME`) VALUES
('CA NHAN'),
('DAY HOC'),
('DU AN'),
('LAO DONG'),
('XA HOI');

-- --------------------------------------------------------

--
-- Table structure for table `job`
--

CREATE TABLE `job` (
  `ID` int(11) NOT NULL,
  `DEPENDENCY_ID` int(11) NOT NULL,
  `DEPENDENCY_NAME` varchar(100) NOT NULL,
  `NAME` varchar(100) NOT NULL,
  `DESCRIPTION` varchar(400) NOT NULL,
  `CATEGORY` varchar(100) NOT NULL,
  `START_DATE` varchar(1000) NOT NULL,
  `DUE_DATE` varchar(100) NOT NULL,
  `END_DATE` varchar(100) NOT NULL,
  `REQUIRED_HOUR` int(11) NOT NULL,
  `WORKED_HOUR` int(11) NOT NULL,
  `PERCENT` int(11) NOT NULL,
  `ASSIGNOR_ID` int(11) NOT NULL,
  `ASSIGNOR_TYPE` varchar(100) NOT NULL,
  `ASSIGNOR_NAME` varchar(100) NOT NULL,
  `ASSIGNEE_ID` int(11) NOT NULL,
  `ASSIGNEE_TYPE` varchar(100) NOT NULL,
  `ASSIGNEE_NAME` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `job`
--

INSERT INTO `job` (`ID`, `DEPENDENCY_ID`, `DEPENDENCY_NAME`, `NAME`, `DESCRIPTION`, `CATEGORY`, `START_DATE`, `DUE_DATE`, `END_DATE`, `REQUIRED_HOUR`, `WORKED_HOUR`, `PERCENT`, `ASSIGNOR_ID`, `ASSIGNOR_TYPE`, `ASSIGNOR_NAME`, `ASSIGNEE_ID`, `ASSIGNEE_TYPE`, `ASSIGNEE_NAME`) VALUES
(1, -1, 'NONE', 'NIEN LUAN CHUYEN NGANH1', 'NIEN LUAN CHUYEN NGANH, DE TAI: QUAN LY CONG VIEC1', 'DU AN', '06-07-2022', '17-12-2022', 'NONE', 800, 450, 60, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(2, 1, 'CV ADMIN ROOT', 'BACKEND NLCN', 'THIET KE CO SO DU LIEU', 'DU AN', '11-07-2022', '14-07-2022', '12-07-2022', 5, 3, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(3, 1, 'NIEN LUAN CHUYEN NGANH', 'FRONTEND NLCN', 'SU DUNG WPF VA MO HINH MVVM THIET KE GIAO DIEN UNG DUNG', 'DU AN', '20-07-2022', '03-12-2022', 'NONE', 500, 302, 30, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(4, 1, 'NIEN LUAN CHUYEN NGANH', 'VIET FILE BAO CAO', 'VIET FILE BAO CAO DANG DOCX VA PPT', 'DU AN', '01-12-2022', '03-12-2022', '02-12-2022', 10, 4, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(5, 2, 'CV ADMIN 1', 'TRIGGER TU CHINH TEN', 'TRIGGER TU CHINH TEN', 'DU AN', '14-07-2022', '14-07-2022', '15-07-2022', 2, 0, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(6, 5, 'TRIGGER TU CHINH TEN', 'TRIGGER XOA REPORT', 'TRIGGER XOA REPORT NEU ID DOI', 'DU AN', '15-07-2022', '15-07-2022', 'NONE', 12, 3, 40, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(7, 2, 'BACKEND NLCN', 'TRIGGER TINH GIO LAM', 'TRIGGER TINH GIO LAM', 'DU AN', '16-07-2022', '16-07-2022', '16-07-2022', 1, 1, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(8, 3, 'FRONTEND NLCN', 'VE GIAO DIEN BANG FIGMA', 'VE GIAO DIEN BANG FIGMA', 'DU AN', '22-07-2022', '26-07-2022', '25-07-2022', 31, 9, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(9, 1, 'NIEN LUAN CHUYEN NGANH', 'KHAO SAT TINH THUC TIEN', 'YEU CAU CHAU NGOC HUNG THUC HIEN KHAO SAT UNG DUNG', 'DU AN', '27-11-2022', '30-11-2022', '01-12-2022', 20, 6, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'USER', 'CHAU NGOC HUNG'),
(10, -1, 'NONE', 'DON DEP SAN TRUONG', 'DON DEP SAN TRUONG', 'LAO DONG', '11-12-2022', '11-12-2022', '11-12-2022', 2, 1, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(11, -1, 'NONE', 'HO TRO NGUOI NGHEO', 'THAM GIA HOAT DONG HO TRO NGUOI NGHEO O HAU GIANG', 'XA HOI', '03-12-2022', '06-12-2022', 'NONE', 30, 0, 0, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(12, -1, 'NONE', 'DAY TRE EM KHUYET TAT', 'DAY TRE EM KHUYET TAT', 'XA HOI', '11-12-2022', '11-12-2022', 'NONE', 12, 0, 0, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(13, -1, 'NONE', 'BAO CAO NHOM ANMT', 'BAO CAO NHOM AN NINH MAY TINH', 'CA NHAN', '14-12-2022', '14-12-2022', 'NONE', 1, 0, 0, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(14, -1, 'NONE', 'BAO CAO VOI CO THU', 'BAO CAO VOI CO THU', 'CA NHAN', '13-12-2022', '13-12-2022', 'NONE', 2, 0, 0, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA'),
(15, -1, 'NONE', 'TIEU LUAN XU HUONG MUA HANG', 'THUC HIEN TIEU LUAN VE XU XUONG MUA HANG CUA NGUOI TIEU DUNG VE LINH VUC DIEN TU TAI KHU VUC CAN THO', 'DU AN', '06-04-2022', '26-12-2022', 'NONE', 500, 346, 60, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(16, 15, 'TIEU LUAN XU HUONG MUA HANG', 'SOAN CAU HOI KHAO SAT', 'SOAN BO CAU HOI DE KHAO SAT TAI KHU VUC CAN THO', 'DAY HOC', '08-04-2022', '10-04-2022', '09-04-2022', 2, 1, 100, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(17, 16, 'SOAN CAU HOI KHAO SAT', 'LIEN HE CAC TO CHUC MUA BAN', 'LIEN HE CAC CUC HANG MUA BAN DO DUNG DIEN TU, DE THUC HIEN KHAO SAT', 'DU AN', '09-04-2022', '11-04-2022', '13-04-2022', 10, 7, 100, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(18, 16, 'SOAN CAU HOI KHAO SAT', 'LIEN HE NGUOI DUNG', 'LIEN HE NHOM NGUOI DUNG MUA DO DIEN TU', 'DU AN', '15-04-2022', '20-04-2022', 'NONE', 20, 18, 60, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(19, 15, 'TIEU LUAN XU HUONG MUA HANG', 'TAO FILE BAO CAO PDF, PPT', 'TAO FILE BAO CAO DOCX, PDF VAF POWERPOINT CHO CO VAN HOC TAP', 'DU AN', '19-04-2022', '23-04-2022', 'NONE', 25, 22, 80, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(20, 19, 'TAO FILE BAO CAO PDF, PPT', 'BAO CAO VOI CO VAN', 'BAO CAO VOI CO VAN HOC TAP VE TIEU LUAN XU HUONG TIEU DUNG ', 'DU AN', '02-08-2022', '25-08-2022', 'NONE', 4, 2, 90, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(21, 15, 'TIEU LUAN XU HUONG MUA HANG', 'KIEM THU FILE BAO CAO', 'KIEM THU FILE BAO CAO', 'DU AN', '01-12-2022', '03-12-2022', '02-12-2022', 1, 1, 100, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(22, -1, 'NONE', 'HIEN MAU NHAN DAO', 'HIEN MAU NHAN DAO TAI HOP TAC GIA THANH TAN', 'XA HOI', '10-12-2022', '10-12-2022', 'NONE', 2, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(23, -1, 'NONE', 'DU LICH DA LAT', 'DU LICH DA LAT', 'CA NHAN', '13-12-2022', '21-12-2022', 'NONE', 200, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(24, 23, 'DU LICH DA LAT1', 'SOAN DO DU LICH', 'SOAN DO DU LICH DA LAT', 'CA NHAN', '15-12-2022', '16-12-2022', 'NONE', 12, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(25, -1, 'NONE', 'GIUP DO NGUOI KHUYET TAT', 'GIUP DO NGUOI KHUYET TAT', 'XA HOI', '11-12-2022', '12-12-2022', '11-12-2022', 24, 13, 100, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(26, -1, 'NONE', 'THAM GIA NGAY HOI VIEC LAM', 'THAM GIA NGAY HOI VIEC LAM', 'CA NHAN', '11-12-2022', '11-12-2022', 'NONE', 5, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(27, -1, 'NONE', 'LAO DONG KKT', 'LAO DONG KKT', 'LAO DONG', '06-12-2022', '12-12-2022', 'NONE', 2, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 1, 'USER', 'CHAU NGOC HUNG'),
(28, -1, 'NONE', 'THUC TAP TAI BENH VIEN CT', 'THUC TAP TAI BENH VIEN CAN THO', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 600, 180, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 2, 'USER', 'HO VINH DUY'),
(29, -1, 'NONE', 'THUC TAP TAI NASA', 'THUC TAP TAI NASA', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 1000, 300, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 3, 'USER', 'DUONG HUYNH NHAN'),
(30, -1, 'NONE', 'THUC TAP TAI Y DUOC HG', 'THUC TAP TAI Y DUOC HG', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 1200, 360, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 4, 'USER', 'NGO NHAT TRUONG'),
(31, -1, 'NONE', 'LAM VIEC TAI LAC TY', 'LAM VIEC TAI LAC TY', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 2300, 690, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 6, 'USER', 'TO PHAM QUOC ANH'),
(32, -1, 'NONE', 'THI LAI XE B2', 'THI LAI XE B2', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 299, 89, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 6, 'USER', 'TO PHAM QUOC ANH'),
(33, -1, 'NONE', 'THUC TAP TAI TOA', 'THUC TAP TAI TOA', 'CA NHAN', '11-12-2022', '11-12-2022', '11-12-2022', 200, 60, 100, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 5, 'USER', 'LAM PHUC'),
(38, -1, 'NONE', 'REST2', 'REST2', 'CA NHAN', '11-12-2022', '11-12-2022', 'NONE', 213, 0, 0, 1, 'USER', 'CHAU NGOC HUNG', 2, 'USER', 'HO VINH DUY'),
(40, -1, 'NONE', 'CHUAN BI INTERGATED REPORT', 'CHUAN BI INTERGATED REPORT', 'DU AN', '14-12-2022', '14-12-2022', 'NONE', 10, 0, 0, 1, 'ADMIN', 'HUYNH HUU BAO KHOA', 1, 'ADMIN', 'HUYNH HUU BAO KHOA');

--
-- Triggers `job`
--
DELIMITER $$
CREATE TRIGGER `AUTO_DEL_REPORT_WHEN_JOB_CHANGE_ASSIGNEE` AFTER UPDATE ON `job` FOR EACH ROW BEGIN  
	IF ( ( NEW.ASSIGNEE_TYPE != OLD.ASSIGNEE_TYPE  ) || (NEW.ASSIGNEE_TYPE = OLD.ASSIGNEE_TYPE && NEW.ASSIGNEE_ID != OLD.ASSIGNEE_ID)) THEN
			DELETE FROM REPORT WHERE JOB_ID = NEW.ID;
	END IF;
	IF ( OLD.ASSIGNEE_TYPE = "ADMIN" ) THEN
			UPDATE ADMIN SET TOTAL_WORKING_HOUR = (SELECT SUM(WORKED_HOUR) FROM JOB WHERE ASSIGNEE_TYPE = "ADMIN" AND ASSIGNEE_ID = OLD.ASSIGNEE_ID) WHERE ID = OLD.ASSIGNEE_ID; 
	END IF;
	IF ( OLD.ASSIGNEE_TYPE = "USER" ) THEN
			UPDATE USER SET TOTAL_WORKING_HOUR = (SELECT SUM(WORKED_HOUR) FROM JOB WHERE ASSIGNEE_TYPE = "USER" AND ASSIGNEE_ID = OLD.ASSIGNEE_ID) WHERE ID = OLD.ASSIGNEE_ID; 
	END IF;
	IF ( NEW.ASSIGNEE_TYPE = "ADMIN" ) THEN
			UPDATE ADMIN SET TOTAL_WORKING_HOUR = (SELECT SUM(WORKED_HOUR) FROM JOB WHERE ASSIGNEE_TYPE = "ADMIN" AND ASSIGNEE_ID = NEW.ASSIGNEE_ID) WHERE ID = NEW.ASSIGNEE_ID; 
	END IF;
	IF ( NEW.ASSIGNEE_TYPE = "USER" ) THEN
			UPDATE USER SET TOTAL_WORKING_HOUR = (SELECT SUM(WORKED_HOUR) FROM JOB WHERE ASSIGNEE_TYPE = "USER" AND ASSIGNEE_ID = NEW.ASSIGNEE_ID) WHERE ID = NEW.ASSIGNEE_ID; 
	END IF;
END
$$
DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `organization`
--

CREATE TABLE `organization` (
  `NAME` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `organization`
--

INSERT INTO `organization` (`NAME`) VALUES
('DAI HOC CAN THO'),
('KHOA CONG NGHE'),
('KHOA CONG NGHE THONG TIN VA TRUYEN THONG'),
('KHOA KINH TE'),
('KHOA NONG NGHIEP'),
('KHOA XA HOI');

-- --------------------------------------------------------

--
-- Table structure for table `organization_position`
--

CREATE TABLE `organization_position` (
  `ORGANIZATION_NAME` varchar(100) NOT NULL,
  `NAME` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `organization_position`
--

INSERT INTO `organization_position` (`ORGANIZATION_NAME`, `NAME`) VALUES
('DAI HOC CAN THO', 'HIEU PHO'),
('DAI HOC CAN THO', 'HIEU TRUONG'),
('KHOA CONG NGHE', 'PHO KHOA'),
('KHOA CONG NGHE', 'TRUONG KHOA'),
('KHOA CONG NGHE THONG TIN VA TRUYEN THONG', 'PHO KHOA'),
('KHOA CONG NGHE THONG TIN VA TRUYEN THONG', 'TRUONG KHOA'),
('KHOA KINH TE', 'PHO KHOA'),
('KHOA KINH TE', 'TRUONG KHOA'),
('KHOA NONG NGHIEP', 'TRUONG KHOA'),
('KHOA XA HOI', 'PHO KHOA'),
('KHOA XA HOI', 'TRUONG KHOA');

-- --------------------------------------------------------

--
-- Table structure for table `report`
--

CREATE TABLE `report` (
  `ID` int(11) NOT NULL,
  `JOB_ID` int(11) DEFAULT NULL,
  `JOB_NAME` varchar(100) NOT NULL,
  `TILE` varchar(100) NOT NULL,
  `DESCRIPTION` varchar(400) NOT NULL,
  `CREATED_TIME` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `report`
--

INSERT INTO `report` (`ID`, `JOB_ID`, `JOB_NAME`, `TILE`, `DESCRIPTION`, `CREATED_TIME`) VALUES
(1, 1, 'NIEN LUAN CHUYEN NGANH', 'HOC WPF CO BAN', 'HOC VE WPF CO BAN TRONG KHOA HOC O KTEAM', '08-07-2022 07:10 AM'),
(2, 1, 'NIEN LUAN CHUYEN NGANH', 'VAN DE VE NGON NGU C#', 'GAP VAN DE TRONG VIEC BAT LOI NULL TRONG NGON CU C#', '10-07-2022 05:11 PM'),
(3, 1, 'NIEN LUAN CHUYEN NGANH', 'KHAC PHUC BAT LOI TRONG C#', 'DA QUEN VOI CACH BAT LOI NULL O C# QUA SU GIUP DO TREN STACKOVERFLOW', '11-07-2022 05:11 PM'),
(4, 1, 'NIEN LUAN CHUYEN NGANH', 'VAN DE BINDING MO HINH MVVM', 'TWO WAY BINDING DU LIEU GIUA VIEWMODEL VA VIEW KHONG THANH CONG', '13-07-2022 05:25 PM'),
(5, 1, 'NIEN LUAN CHUYEN NGANH', 'FIX TWO WAY BINDING', 'DA KHAT PHUC DUOC TWOWAY BINDING BANG CACH TAO THEM 1 CLASS BASSVIEW MOI THUOC TINH ONPROPERTIES CHANGE', '14-07-2022 02:07 PM'),
(6, 2, 'BACKEND NLCN', 'TAO THANH CONG CSDL', 'TAO THANH CONG CSDL', '13-07-2022 08:22 AM'),
(7, 5, 'TRIGGER TU CHINH TEN', 'TAO TRIGGER TU DOI TEN THANH CONG', 'TAO TRIGGER TU DOI TEN THANH CONG', '15-07-2022 01:52 PM'),
(8, 6, 'TRIGGER XOA REPORT', 'DUNG DO TRIGGER', 'GAP LOI DUNG DO TRIGGER KHI CUNG TAC DONG VAO 1 BANG TRONG MYSQL', '16-07-2022 01:20 AM'),
(9, 6, 'TRIGGER XOA REPORT', 'KHONG KHAT PHUC DC LOI DUNG DO', 'KHONG KHAT PHUC DC LOI DUNG DO TRIGGER, CHUYEN SANG SU XI O CODE BEHIND O SERVICE ', '18-07-2022 01:20 AM'),
(10, 9, 'KHAO SAT TINH THUC TIEN', 'KHAO SAT TRUONG THPT CAI TAC', 'DA THUC HIEN KHAO SAT VOI CAI GIAO VIEN TRUONG THPT CAI TAT', '07-12-2022 12:00 AM'),
(11, 15, 'TIEU LUAN XU HUONG MUA HANG', 'THAM KHAO CAC DE TAI LIEN QUAN', 'DA THAM KHAO CAC TIEU LUAN, DE TAI LIEN QUAN TAI DOCUMENT.VN, VA TAI THU VIEN TRUONG', '16-04-2022 04:21 AM'),
(12, 15, 'TIEU LUAN XU HUONG MUA HANG', 'VAN DE SOAN THAO', 'GAP VAN DE TRONG VIEC SOAN THAO VAN BAN DUNG CAU TRUC', '19-04-2022 09:40 PM'),
(13, 16, 'SOAN CAU HOI KHAO SAT', 'SOAN THANH CONG', 'SOAN CAU TRUC CAU HOI THANH CONG', '09-04-2022 03:40 PM'),
(14, 17, 'LIEN HE CAC TO CHUC MUA BAN', 'LIEN HE DIEN MAY XANH', 'DA LIEN HE VAO THUC HIEN KHAO SAT VOI CAC NHAN VIEN CUA DIEN MAY XANH', '10-04-2022 06:46 AM'),
(15, 17, 'LIEN HE CAC TO CHUC MUA BAN', 'LIEN HE KHAO SAT SCHANNEL', 'DA LIEN HE VAO THUC HIEN KHAO SAT VOI CAC NHAN VIEN CUA SCHANNEL', '12-04-2022 05:40 PM'),
(16, 17, 'LIEN HE CAC TO CHUC MUA BAN', 'LIEN HE KHAO SAT NGUYEN KIM', 'DA LIEN HE VAO THUC HIEN KHAO SAT VOI CAC NHAN VIEN CUA NGUYEN KIM', '12-04-2022 02:57 PM'),
(17, 18, 'LIEN HE NGUOI DUNG', 'KHAO SAT NGUOI DUNG TAI CAN THO', 'KHAT SAT NGUOI DUNG TAI CAN THO', '16-04-2022 07:18 AM'),
(18, 18, 'LIEN HE NGUOI DUNG', 'VAN DE XAC DINH NHOM NGUOI DUNG', 'VAN DE XAC DINH NHOM NGUOI DUNG TREN CAC NEN TANG XA HOI DE THUC HIEN KHAO SAT', '18-04-2022 08:16 AM'),
(19, 19, 'TAO FILE BAO CAO PDF, PPT', 'VAN DE DINH DANG BAO CAO', 'GAP VAN DE TRONG VIEC DINH DANG BAO CAO, FONT CHU, CANH LE TRAI PHAI, KHOANG CACH DONG', '20-05-2022 04:30 AM'),
(20, 19, 'TAO FILE BAO CAO PDF, PPT', 'DA LAM XONG BAO CAO DOCX', 'DA LAM XONG BAO CAO DOCX VE TIEU LUAN KHAO SAT NGUOI TIEU DUNG', '17-11-2022 03:40 PM'),
(21, 19, 'TAO FILE BAO CAO PDF, PPT', 'DA LAM XONG BAO CAO PPT', 'DA LAM XONG BAO CAO POWERPOINT VE TIEU LUAN KHAO SAT NGUOI TIEU DUNG', '19-11-2022 02:31 PM'),
(22, 21, 'KIEM THU FILE BAO CAO', 'DA KIEM THU FILE DOCX', 'DA KIEM THU FILE DOCX', '02-12-2022 09:13 AM'),
(23, 21, 'KIEM THU FILE BAO CAO', 'DA KIEM THU FILE PPT', 'DA KIEM THU FILE PPT', '04-12-2022 10:06 PM'),
(31, 1, 'NIEN LUAN CHUYEN NGANH1', 'TEST THEM BAO CAO', 'TEST THEM BAO CAO', '13-12-2022 12:00 AM');

-- --------------------------------------------------------

--
-- Table structure for table `user`
--

CREATE TABLE `user` (
  `ID` int(11) NOT NULL,
  `NAME` varchar(100) NOT NULL,
  `GENDER` varchar(30) NOT NULL,
  `D_O_B` varchar(100) NOT NULL,
  `PHONE` varchar(10) NOT NULL,
  `ADDRESS` varchar(200) NOT NULL,
  `ORGANIZATION` varchar(50) NOT NULL,
  `POSITION` varchar(50) NOT NULL,
  `AVATAR` longblob NOT NULL,
  `EMAIL` varchar(50) NOT NULL,
  `USERNAME` varchar(50) NOT NULL,
  `PASS` varchar(300) NOT NULL,
  `QUESTION` varchar(200) NOT NULL,
  `ANSWER` varchar(200) NOT NULL,
  `TOTAL_WORKING_HOUR` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `user`
--

INSERT INTO `user` (`ID`, `NAME`, `GENDER`, `D_O_B`, `PHONE`, `ADDRESS`, `ORGANIZATION`, `POSITION`, `AVATAR`, `EMAIL`, `USERNAME`, `PASS`, `QUESTION`, `ANSWER`, `TOTAL_WORKING_HOUR`) VALUES
(1, 'CHAU NGOC HUNG', 'NAM', '21-12-2001', '0372753981', '12, CHAU THANH, HAU GIANG', 'DAI HOC CAN THO', 'HIEU TRUONG', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'USER1@GMAIL.COM', 'USER1', '684B561B9C1B38B7B56C63B2E20167', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'HUNG', 416),
(2, 'HO VINH DUY', 'NAM', '02-12-2001', '0372753982', 'TP HO CHI MINH', 'DAI HOC CAN THO', 'HIEU PHO', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'USER2@GMAIL.COM', 'USER2', 'USER2', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'DUY', 180),
(3, 'DUONG HUYNH NHAN', 'NAM', '08-08-2001', '0372753983', 'NGAY BAY, HAU GIANG', 'KHOA CONG NGHE THONG TIN VA TRUYEN THONG', 'TRUONG KHOA', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'USER3@GMAIL.COM', 'USER3', 'USER3', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'NHAN', 300),
(4, 'NGO NHAT TRUONG', 'NAM', '06-12-2000', '0372753984', 'TAN HOA, NGHE AN', 'KHOA CONG NGHE THONG TIN VA TRUYEN THONG', 'PHO KHOA', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'USER4@GMAIL.COM', 'USER4', 'USER4', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'TRUONG', 360),
(5, 'LAM PHUC', 'NAM', '11-12-2002', '0917437738', 'CHAU DOC', 'KHOA CONG NGHE', 'TRUONG KHOA', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'LPHUC@GMAIL.COM', 'USER5', 'MTA3t3', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'PHUC', 60),
(6, 'TO PHAM QUOC ANH', 'NAM', '11-12-2002', '0917437739', 'HAU GIANG', 'KHOA CONG NGHE', 'PHO KHOA', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'QANH@GMAIL.COM', 'USER6', 'EtfKOQ', 'WHAT WAS YOUR CHILDHOOD NICKNAME?', 'QUOC ANH', 779),
(7, 'NHAN VIEN', 'NAM', '12-12-2002', '0916456484', 'HAU GIANG', 'KHOA NONG NGHIEP', 'TRUONG KHOA', 0x433a2f78616d70702f6874646f63732f62616e6b2f696d616765732f6176617461722f312e6a7067, 'NV1@GMAIL.COM', 'NV1', 'YVwLho', 'WHAT IS THE NAME OF THE TOWN WHERE YOU WERE BORN?', 'NV1', 0);

--
-- Triggers `user`
--
DELIMITER $$
CREATE TRIGGER `AUTO_DEL_JOB_WHEN_DEL_USER` AFTER DELETE ON `user` FOR EACH ROW BEGIN  
DELETE FROM JOB WHERE (ASSIGNOR_TYPE = 'USER' AND ASSIGNOR_ID = OLD.ID) OR (ASSIGNEE_TYPE = 'USER' AND ASSIGNEE_ID = OLD.ID);

END
$$
DELIMITER ;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `admin`
--
ALTER TABLE `admin`
  ADD PRIMARY KEY (`ID`),
  ADD UNIQUE KEY `USERNAME` (`USERNAME`);

--
-- Indexes for table `category`
--
ALTER TABLE `category`
  ADD PRIMARY KEY (`NAME`);

--
-- Indexes for table `job`
--
ALTER TABLE `job`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `fk_JOB_CATEGORY` (`CATEGORY`);

--
-- Indexes for table `organization`
--
ALTER TABLE `organization`
  ADD PRIMARY KEY (`NAME`);

--
-- Indexes for table `organization_position`
--
ALTER TABLE `organization_position`
  ADD PRIMARY KEY (`ORGANIZATION_NAME`,`NAME`);

--
-- Indexes for table `report`
--
ALTER TABLE `report`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `fk_REPORT` (`JOB_ID`);

--
-- Indexes for table `user`
--
ALTER TABLE `user`
  ADD PRIMARY KEY (`ID`),
  ADD UNIQUE KEY `USERNAME` (`USERNAME`),
  ADD KEY `fk_USER2` (`ORGANIZATION`,`POSITION`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `admin`
--
ALTER TABLE `admin`
  MODIFY `ID` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT for table `job`
--
ALTER TABLE `job`
  MODIFY `ID` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=53;

--
-- AUTO_INCREMENT for table `report`
--
ALTER TABLE `report`
  MODIFY `ID` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=32;

--
-- AUTO_INCREMENT for table `user`
--
ALTER TABLE `user`
  MODIFY `ID` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=8;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `job`
--
ALTER TABLE `job`
  ADD CONSTRAINT `fk_JOB_CATEGORY` FOREIGN KEY (`CATEGORY`) REFERENCES `category` (`NAME`) ON DELETE CASCADE;

--
-- Constraints for table `organization_position`
--
ALTER TABLE `organization_position`
  ADD CONSTRAINT `fk_ORGANIZATION_POSITION` FOREIGN KEY (`ORGANIZATION_NAME`) REFERENCES `organization` (`NAME`) ON DELETE CASCADE;

--
-- Constraints for table `report`
--
ALTER TABLE `report`
  ADD CONSTRAINT `fk_REPORT` FOREIGN KEY (`JOB_ID`) REFERENCES `job` (`ID`) ON DELETE CASCADE;

--
-- Constraints for table `user`
--
ALTER TABLE `user`
  ADD CONSTRAINT `fk_USER1` FOREIGN KEY (`ORGANIZATION`) REFERENCES `organization` (`NAME`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_USER2` FOREIGN KEY (`ORGANIZATION`,`POSITION`) REFERENCES `organization_position` (`ORGANIZATION_NAME`, `NAME`) ON DELETE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
